---
title: "figure5"
author: "Shangsi Lin"
date: "2025-01-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("figure5.R")
```

```{r Figure5d}
df=read_xlsx("Data/sgRNA/Figure5/N100M_sequence_result/N100M_plot.xlsx") %>% 
  janitor::clean_names()
print(tibble(df), n = 100)

ggplot(df, aes(x = monoisotopic_mass, y = apex_rt, color = log10(sum_intensity), shape = ladder_type, group = ladder_type)) +
  geom_point(size = 3) +  # Add points
  geom_line(color = "gray34", alpha = 0.5) +  # Add lines connecting points within the same ladder_type
  scale_x_continuous(name = "Monoisotopic Mass (Da)", breaks = seq(0, max(df$monoisotopic_mass, na.rm = TRUE), by = 2000)) +
  scale_y_continuous(name = "Retention Time (min)", breaks = seq(0, max(df$apex_rt, na.rm = TRUE), by = 2)) +
  labs(color = "Log10(Intensity)", shape = "Ladder Type") +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12, face = "bold"),
    axis.title.y = element_text(size = 12, face = "bold"),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 10)
  ) +
  scale_color_gradientn(colors = turbo(256))  # Use turbo color scale for the color aesthetic
```

```{r Figure5c}
df=read_xlsx("Data/sgRNA/Figure5/N100N_sequence_result/N100N_plot.xlsx") %>% 
  janitor::clean_names()
print(tibble(df), n = 100)

ggplot(df, aes(x = monoisotopic_mass, y = apex_rt, color = log10(sum_intensity), shape = ladder_type, group = ladder_type)) +
  geom_point(size = 3) +  # Add points
  geom_line(color = "gray34", alpha = 0.5) +  # Add lines connecting points within the same ladder_type
  scale_x_continuous(name = "Monoisotopic Mass (Da)", breaks = seq(0, max(df$monoisotopic_mass, na.rm = TRUE), by = 2000)) +
  scale_y_continuous(name = "Retention Time (min)", breaks = seq(0, max(df$apex_rt, na.rm = TRUE), by = 2)) +
  labs(color = "Log10(Intensity)", shape = "Ladder Type") +
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 12, face = "bold"),
    axis.title.y = element_text(size = 12, face = "bold"),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    legend.title = element_text(size = 12, face = "bold"),
    legend.text = element_text(size = 10)
  ) +
  scale_color_gradientn(colors = turbo(256))  # Use turbo color scale for the color aesthetic
```